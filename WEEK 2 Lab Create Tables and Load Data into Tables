--Lab: Create Tables using SQL Scripts and Load Data into Tables from csv files
--IBM Db2 on Cloud

--you will learn how to run SQL scripts to create several tables at once, as well as how to load data into tables from .csv files.

--The database used in this lab is an internal database. 
--You will be working on a sample HR database. 
--This HR database schema consists of 5 tables called EMPLOYEES, JOB_HISTORY, JOBS, DEPARTMENTS and LOCATIONS.

--EXERCISE 1: Create tables using SQL scripts
--In this exercise, you will learn how to execute a script containing the CREATE TABLE commands for all the tables 
--rather than create each table manually by typing the DDL commands in the SQL editor.

--1. Download the script file to your computer:
-- (HR_Database_Create_Tables_Script.sql)
--2. connect to IBM Db2 on Cloud
--3. Click on the + (Add New Script) icon.
--4. Click on From file.
--5. Locate the file HR_Database_Create_Tables_Script.sql that you downloaded to your computer earlier and open it.
--6. Once the statements are in the SQL Editor tool , you can run the queries against the database by selecting the Run All button
--7. On the right side of the SQL editor window you will see a Result section. 
--Clicking on a query in the Result section will show the execution details of the job like whether it ran successfully, or had any errors or warnings. 
--Ensure your queries ran successfully and created all the tables.
--8. Now you can look at the tables you created. Navigate to the 3-bar menu icon in the top left corner, select Explore, and then click on Tables.
--9. Select the Schema corresponding to your Db2 userid
--10. Click on any of the tables and you will see its Table Definition (that is, its list of columns, data types, etc).

--EXERCISE 2: Load data into tables

--In this exercise, you will learn how data can be loaded into Db2. 
--You could manually insert each row into the table one by one, but that would take a long time. 
--Instead, Db2 (and almost every other database) allows you to load data from .CSV files.

--1. Download the 5 .csv files below to your local computer:
--Departments.csv
--Employees.csv
--Jobs.csv
--Locations.csv
--JobsHistory.csv
--2. In the Db2 Console, from the 3-bar menu icon in the top left corner, click Load, and then select Load Data.
--3. On the Load Data page that opens, ensure My Computer is selected as the source. Click on the browse files link.
--4.Choose the file Employees.csv that you downloaded to your computer and click Open.
--5.Once the File is selected, click Next in the bottom right corner.
--6. Select the schema for your Db2 Userid 
--7. It will show all the tables that have been created in this schema previously, including the Employees table. 
--Select the EMPLOYEES table, and in the new Table Definition tab that appears, choose Overwrite table with new data (note the warning message), then click Next.
--8.Since the source data files do not contain any rows with column labels, turn off the setting for Header in first row. 
--Also, click on the down arrow next to Date format and choose MM/DD/YYYY since that is how the date is formatted in the source file.
--9. Click Next. Review the load settings and click Begin Load in the bottom right corner.
--10. After loading has completed, you will notice that you were successful in loading all 10 rows of the Employees table. If there are any Errors or Warnings, you can see them on this screen.
--11. You can see the data that was loaded by clicking on View Table. 
--Alternatively, you can go to 3-bar menu icon > Explore > Tables and select the correct Schema. 
--Then click on the EMPLOYEES table. Click View Data at the bottom.
--12. Now it's your turn to load data to the remaining 4 tables of the HR database â€“ LOCATIONS, JOB_HISTORY, JOBS, and DEPARTMENTS from the remaining source files.
--13. Click Load More Data and then follow the steps from Step 3 above again to load the remaining 4 tables. IMPORTANT Make sure you perform the steps in Step 8 for each of the 4 remaining file loads.

